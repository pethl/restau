<br>
<%= form_tag(bookings_path, :method => "get", id: "search-form") do %>
    <%= date_select :search, params[:search], placeholder: "Search by booking date" %>
    <%= submit_tag "Search" %>
<% end %>

<h3>Showing bookings for : <%= @bookings.first.booking_date.strftime('%A, %d %B %Y') %></h3>
<br>
 <% @results = reformat_bookings_into_single_line(@bookings_by_table) %>

 <TABLE class="table table-bordered">
 <tr>
 <th></th>
 <th colspan="2" style="text-align:center">11.00</th>
 <th colspan="2" style="text-align:center">12.00</th>
 <th colspan="2" style="text-align:center">13.00</th>
 <th colspan="2" style="text-align:center">14.00</th>
 <th colspan="2" style="text-align:center">15.00</th>
 <th colspan="2" style="text-align:center">16.00</th>
 <th colspan="2" style="text-align:center">17.00</th>
 <th colspan="2" style="text-align:center">18.00</th>
 <th colspan="2" style="text-align:center">19.00</th>
 <th colspan="2" style="text-align:center">20.00</th>
 <th colspan="2" style="text-align:center">21.00</th>
 <th colspan="2" style="text-align:center">22.00</th>
 <th colspan="2" style="text-align:center">23.00</th>
 </tr>
 <tr>
 <td></td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 <td>0</td>
 <td>30</td>
 </tr>
 
 <% @results.each do |key, array| %>
   <tr>
      <td><%= Table.where(:id => key).first.reference %>:
      <%= Table.where(:id => key).first.desc %></td>
 <% array.each do |entry| %>
   
   <% case entry[1] %>
     <% when 1 %>
      <td class="success"></td>
   <% when 2 %>
     <td class="danger">...</td>
    <% when 0 %>
    <td></td>
    <% end %>
   <% end %>
</tr>
<% end %>
</table> 

<br><br>
Booking details for :<%= @bookings.first.booking_date.strftime('%A, %d %B %Y') %>
<br><br>

<table class="table ">
  <thead>
    <tr>
      <th>Table</th>
      <th>Customer</th>
      <th>Number</th>
      <th>Booking time</th>
      <th>Number of diners</th>
      <th>Accessible</th>
      <th>Child friendly</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @bookings_by_table.sort_by(&:first).each do |table, bookings| %>
     
   **BUG HERE NEED TO REMOVE UNCONFIRMED BOOKINGS**
      <tr>
        <td colspan="5" ><% unless table.nil? %>
          <%= Table.where(:id => table).first.reference %> - <%= Table.where(:id => table).first.desc %><% end %></td>
      </tr>
          <% bookings = bookings.sort_by { |hsh| hsh[:booking_time] }%>
            <% bookings.each do |booking| %>
              <% if booking.status == "Confirmed" %>
        <tr>
        <td></td>
        <td><strong><%= booking.name %></strong></td>
        <td><%= booking.phone %></td>
       
        <td><%= booking.booking_time.strftime('%H:%M')   %></td>
        <td><%= booking.number_of_diners %></td>
        <td><%= booking.accessible %></td>
        <td><%= booking.child_friendly %></td>
      </tr>
    <% end %>    <% end %><% end %>
  </tbody>
</table>



 