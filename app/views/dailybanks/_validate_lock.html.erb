<%= form_for(@dailybank) do |f| %>
  <% if @dailybank.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@dailybank.errors.count, "error") %> prohibited this dailybank from being saved:</h2>

      <ul>
      <% @dailybank.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
   
  <h6><small>1. Check all values, if changes are made use RE-CALCULATE button.<br>
  2. If variance more than +/- £1, reason must be given.<br>
  3. Click FINISH END OF NIGHT to submit for mgmt review.</small></h6>
<br>
<div class="row">
  <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :till_float %></font><br>
  <font color=#D3D3D3><%= f.label :till_cash %></font><br>
  </div>
  <div class="col-md-2">
  <%= f.text_field :till_float, :style => "width:74px; text-align:right", readonly: true %> <br>
  <%= f.text_field :till_cash, :style => "width:74px; text-align:right" %> <br>
  </div>
  <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :banking, "Banking Total" %></font><br>
  </div>       
  <div class="col-md-2">
  <%= f.text_field :banking, :disabled=>true, :style => "width:74px; text-align:right" %> <br>
  </div>  
  <div class="col-md-3"> 
  
  </div>      
</div>

<div class="row">
  <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :card_1 %></font><br>
  <font color=#D3D3D3><%= f.label :card_2 %></font><br>
  </div>
  <div class="col-md-2">
  <%= f.text_field :card_1, :style => "width:74px; text-align:right" %> <br>
  <%= f.text_field :card_2, :style => "width:74px; text-align:right" %> <br>
  </div>
  <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :banking, "Cards Total" %></font><br>
  </div>       
  <div class="col-md-2">
  <%= f.text_field :card_payments, :disabled=>true, :style => "width:74px; text-align:right" %> <br>
  </div> 
  <div class="col-md-3"> 
   
  </div>        
</div>  

<div class="row">
<% if @dailybank.expenses.any? %>
  <div class="col-md-2"> 
  <font color=#D3D3D3><b>No. of Expenses (<%= @dailybank.expenses.count %>)</b></font>
  </div> 
  <div class="col-md-2" style="vertical-align: middle"><br>
 <%= link_to "See Expenses", show_many_expenses_path(:id => @dailybank.expenses.first.id), :class => "btn btn-xs btn-success", :style => "color:black" %> 
  </div>
  <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :expenses, "Expenses Total" %></font><br>
  </div>       
  <div class="col-md-2">
  <%= f.text_field :expenses_total, :disabled=>true, :style => "width:74px; text-align:right" %> <br>
  </div> 
   <% else %>
   <div class="col-md-8">
    <% end %>
  <div class="col-md-3"> 
   <%= f.text_field :actual_cash_total, :disabled=>true, :style => "width:74px; text-align:right" %> <br>
   <b><font color=#FFDC00>Actual Takings</font></b>
  </div>       
</div>   

 <br>  <br>   

 <div class="row">
   <div class="col-md-2"> 
   <font color=#D3D3D3><%= f.label :wet_takings, "Wet Sales" %></font><br>
   <font color=#D3D3D3><%= f.label :dry_takings, "Dry Sales" %></font><br>
   <font color=#D3D3D3><%= f.label :merch_takings, "Misc Sales" %></font><br>
   </div>
   <div class="col-md-2">
   <%= f.text_field :wet_takings, :style => "width:74px; text-align:right", readonly: true %><br>
   <%= f.text_field :dry_takings, :style => "width:74px; text-align:right", readonly: true %><br>
   <%= f.text_field :merch_takings, :style => "width:74px; text-align:right", readonly: true %>
   </div>
   <div class="col-md-2"> 
   <font color=#D3D3D3><%= f.label :till_takings, "Total Sales" %></font><br>
   </div>       
   <div class="col-md-2">
   <%= f.text_field :till_takings, :disabled=>true, :style => "width:74px; text-align:right" %><br>
   </div>       
 </div> 

 <div class="row">
   <div class="col-md-2"> 
   <font color=#D3D3D3><%= f.label :vouchers_sold, "V's Sold" %></font><br>
   <font color=#D3D3D3><%= f.label :vouchers_used, "V's Used" %></font><br>
   <font color=#D3D3D3><%= f.label :deposit_sold, "D's Sold" %></font><br>
   </div>
   <div class="col-md-2">
   <%= f.text_field :vouchers_sold, :style => "width:74px; text-align:right" %> <br>
   <%= f.text_field :vouchers_used, :style => "width:74px; text-align:right" %> <br>
   <%= f.text_field :deposit_sold, :style => "width:74px; text-align:right" %> <br>
   </div>
   <div class="col-md-2"> 
   <font color=#D3D3D3><%= f.label :v_d_adjustments, "D/V Adjustment" %></font><br>
   </div>       
   <div class="col-md-2">
   <%= f.text_field :v_d_adjustments, :disabled=>true, :style => "width:74px; text-align:right" %> <br>
   </div>       
 </div> 
 
 <div class="row">
   <div class="col-md-2"> 
   <font color=#D3D3D3><%= f.label :deposit_used, "D's Used"%></font>
   </div>
   <div class="col-md-2">
   <%= f.text_field :deposit_used, :style => "width:74px; text-align:right" %> <br>
   </div>
   <div class="col-md-2">
   <font color=#D3D3D3><%= f.label :calculated_variance, "Variance" %> </font> <br>
   </div>
   <div class="col-md-2">
   <%= f.text_field :calculated_variance, :disabled=>true, :style => "width:74px; text-align:right" %>
   </div>   
   <div class="col-md-3"> 
    <%= f.text_field :actual_till_takings, :disabled=>true, :style => "width:74px; text-align:right" %><br>
    <b><font color=#FFDC00>Expected Takings</font></b>
   </div>           
 </div> 
 
<br>
<div class="row">
  <div class="col-md-2 col-md-offset-4"> 
   
   </div>       
    
   <div class="col-md-4">
   
   </div>    
</div>  
 
  <% if @dailybank.calculated_variance.present?&& (@dailybank.calculated_variance < -1 || @dailybank.calculated_variance > 1) %>
    <p><font color=#FF0000>Variance exceeds limit of +/- £1, given reason, then click RE-CALCULATE.</font></p>
<div class="row">
 <div class="col-md-2"> 
  <font color=#D3D3D3><%= f.label :variance_comment, "Variance Reason" %></font>
  </div>       
  <div class="col-md-6">
  <font color=#000000>
  <%= f.text_area :variance_comment, :cols => 48, :rows => 2 %></font>
  </div>       
</div> 
<% end %>

<br>
<div class="row">
 <div class="col-md-2 col-md-offset-2">
   <div class="actions"> 
   <%= f.submit "Re-calculate", class: "btn btn-primary" %>
     <% end %>
      </div>
  </div>
  
   <div class="col-md-2 col-md-offset-1">
    <div class="actions"> 
   <% if (@dailybank.calculated_variance.present? && (@dailybank.calculated_variance > -1 && @dailybank.calculated_variance < 1)) ||( @dailybank.calculated_variance.present? && @dailybank.variance_comment.present?) %>
    
     <%= form_for @dailybank, :url => { :action => "lock_event", params: {id: @dailybank.id} }, :html => { :method => "post" } do |f| %>
        <%= f.hidden_field :status, :value => "Mgmt Review" %>
        <%= f.submit "Finish End of Night", class: "btn btn-primary btn-success" %>
      <% end %>
    <% end %>
  </div>
 </div>
 <div class="col-md-3 col-md-offset-1">
 <h6><%= link_to "Print End of Night report", download_end_of_night_pdf_path(:value => @dailybank.id, :format => 'pdf'), :style => "color:orange" %></h6>
 </div> 
 </div>
 